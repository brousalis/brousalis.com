eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('(g(c){g 1N(E){8 x=E.12(\'.20\',\'\');N x.12(\'#\',\'\')}g 1z(l){6(l.t==\'z\'){l.t=0}o 6(l.t==\'1C\'||l.t==\'1B\'||l.t==\'1A\'){l.t=0.5}o 6(l.t==\'1Z\'){l.t=1}6(l.u==\'A\'){l.u=0}o 6(l.u==\'1C\'||l.u==\'1B\'||l.u==\'1A\'){l.u=0.5}o 6(l.u==\'26\'){l.u=1}}g 1L(4,7,v){8 r={x:0,y:0,13:0};6(!4.M){r.x=v.x-7.x;r.y=v.y-7.y;r.13=24.1X(r.x*r.x+r.y*r.y);v.x=7.x+r.x*4.T;v.y=7.y+r.y*4.T;6(r.13<4.U&&r.13>4.U*-1){4.M=C}}o{v.x=7.x;v.y=7.y}}g 1o(q,4){8 m=4.9.m();c.w(q,{h:q.9.h(),j:q.9.j()});c.w(4,{h:4.9.h(),j:4.9.j(),A:m.A,z:m.z})}g 1e(f,1b,1D){8 m;8 P;6(1W(f)===\'1V\'){6(f.1E(/^\\d+\\s?R$/)!=-1){f=f.12(\'R\',\'\');f=1H(f,10);m=1b*(1D-f);P=1b*15+\'%\';N{f:f,G:C,m:m,P:P}}o 6(f.1E(/^\\d+\\s?%$/)!=-1){f.12(\'%\',\'\');f=1H(f,10)/15}o{f=1}}m=1b*(1-f);N{f:f,G:k,m:m}}g 1n(3,i,4){8 F;8 H;8 p={};3[i]=c.w({},{h:3[i].9.h(),j:3[i].9.j()},3[i]);F=1e(3[i].Q,3[i].t,3[i].h);H=1e(3[i].S,3[i].u,3[i].j);c.w(3[i],{1l:4.h/(3[i].h-4.h),1p:4.j/(3[i].j-4.j),Q:F.f,S:H.f,1s:F.G,1u:H.G,1r:F.m,1K:H.m});6(F.G){p.z=F.P}6(H.G){p.A=H.P}6(F.G||H.G){3[i].9.1i(p)}}g 1Q(3,i,1j){8 1a;c.w(3[i],{b:[]});J(8 n=0;n<3[i].9.I().K;n++){6(!3[i].b[n])3[i].b[n]={};6(!3[i].b[n].9)3[i].b[n][\'9\']=3[i].9.I().1S(n);6(!3[i].b[n].18&&3[i].b[n].9.I(\'a\').1y(\'1J\')){3[i].b[n][\'18\']=3[i].b[n].9.I(\'a\').1y(\'1J\')}6(3[i].b[n].18){1a=3[i].b[n].9.m();c.w(3[i].b[n],{h:3[i].b[n].9.h(),j:3[i].b[n].9.j(),x:1a.z-1j.z,y:1a.A-1j.A});c.w(3[i].b[n],{1U:(3[i].b[n].x+3[i].b[n].h/2)/3[i].h,1M:(3[i].b[n].y+3[i].b[n].j/2)/3[i].j})}}}g 1k(3,1q,1x){8 W;8 X;8 p;J(8 i=0;i<3.K;i++){W=3[i].Q*1q+3[i].1r;X=3[i].S*1x+3[i].1K;p={};6(3[i].11){6(3[i].1s){p.1v=W*-1+\'R\'}o{p.z=W*15+\'%\';p.1v=W*3[i].h*-1+\'R\'}}6(3[i].16){6(3[i].1u){p.1t=X*-1+\'R\'}o{p.A=X*15+\'%\';p.1t=X*3[i].j*-1+\'R\'}}3[i].9.1i(p)}}c.1c.V=g(1F){8 e=c().w({},c.1c.V.e,1F);8 1h={11:e.11,16:e.16,t:e.t,u:e.u,Q:e.Q,S:e.S};8 1g={9:e.4,T:e.T,U:e.U};6(e.4)1g[\'9\']=e.4;8 1d=[];J(8 a=1;a<1T.K;a++){1d.2g(c.w({},1h,1T[a]))}N 1f.2d(g(){8 7={x:0.5,y:0.5};8 v={x:0.5,y:0.5};8 B={O:k,1O:e.1I,19:g(x,y){1L(4,7,v);1k(3,v.x,v.y);1f.O=2c(g(){6(7.x!=x||7.y!=y||!4.M){B.19(7.x,7.y)}o 6(B.O){B.O=k}},B.1O)}};8 q={9:c(1f)};8 4=c.w({},{9:q.9},1g,{Y:k,Z:k,L:k,M:k});8 3=[];g 1R(3,E,1P){J(8 i=0;i<3.K;i++){8 2a=k;J(8 n=0;n<3[i].b.K;n++){6(3[i].b[n].18==E){1P(i,n);N[i,n]}}}N k}1o(q,4);J(8 i=0;i<q.9.I().K;i++){3[i]=c.w({},1h,1d[i],{9:q.9.I(\'*:1S(\'+i+\')\')});1n(3,i,4);6(e.1m){1Q(3,i,q.9.m())}}q.9.I().1i(\'21\',\'1Y\');1k(3,0.5,0.5);6(e.1w){c().2b(g(D){4.Y=(D.17>=4.z&&D.17<4.h+4.z)?C:k;4.Z=(D.14>=4.A&&D.14<4.j+4.A)?C:k;6(4.Y&&4.Z&&!4.L){4.M=k;4.L=C}6(4.L){6(4.Y){7.x=(D.17-4.z)/4.h}o{7.x=(D.17<4.z)?0:1}6(4.Z){7.y=(D.14-4.A)/4.j}o{7.y=(D.14<4.A)?0:1}}6(4.Y&&4.Z){6(!B.O)B.19(7.x,7.y)}o 6(4.L){4.L=k}})}6(e.1m){q.9.22("V",g(27,E){E=1N(E);1R(3,E,g(i,n){7.x=3[i].b[n].1U*(3[i].1l+1)-(0.5*3[i].1l);7.y=3[i].b[n].1M*(3[i].1p+1)-(0.5*3[i].1p);6(!e.1G){6(7.x<0)7.x=0;6(7.x>1)7.x=1;6(7.y<0)7.y=0;6(7.y>1)7.y=1}4.M=k;6(!B.O)B.19(7.x,7.y)})})}c(2e).2f(g(){1o(q,4);J(8 i=0;i<3.K;i++){1n(3,i,4)}})})};c.1c.V.e={1w:C,29:k,1m:C,1G:k,11:C,16:C,t:0.5,u:0.5,Q:1,S:1,T:0.28,U:0.23,1I:25};1z(c.1c.V.e);c(g(){})})(c);',62,141,'|||layer|mouseport||if|localmouse|var|element||content|jQuery||settings|travel|function|width||height|false||offset||else|cssObject|viewport|difference||xorigin|yorigin|virtualmouse|extend|||left|top|timer|true|mouse|ref|xStuff|travelpx|yStuff|children|for|length|active|ontarget|return|running|cssPos|xtravel|px|ytravel|takeoverFactor|takeoverThresh|jparallax|xpos|ypos|xinside|yinside||xparallax|replace|sum|pageY|100|yparallax|pageX|anchor|fire|contentOffset|origin|fn|layersettings|parseTravel|this|settingsMouseport|settingsLayer|css|viewportOffset|moveLayers|diffxrat|triggerResponse|setupLayer|setupPorts|diffyrat|xratio|xoffset|xtravelpx|marginTop|ytravelpx|marginLeft|mouseResponse|yratio|attr|initOrigin|center|centre|middle|dimension|search|options|triggerExposesEdges|parseInt|frameDuration|name|yoffset|positionMouse|posyrat|stripFiletype|frame|callback|setupLayerContents|matrixSearch|eq|arguments|posxrat|string|typeof|sqrt|absolute|right|html|position|bind|002|Math||bottom|event|65|mouseActiveOutside|gotcha|mousemove|setTimeout|each|window|resize|push'.split('|'),0,{}))

// jquery docs
$(document).ready(function($) {
    $('#parallax').jparallax({}, {ytravel:0.5});

  	$('#primary li')
    	.mouseover(function(){    	  
    		$(this).find("a").stop().animate({backgroundPosition:"center -5px"}, {duration:700, easing: "easeOutExpo"})
    		$(this).find("span").stop().animate({top:"55px"}, {duration:700, easing: "easeOutExpo"})
    	})
    	.mouseout(function(){
    		$(this).find("a").stop().animate({backgroundPosition:"center center"}, { duration:700, easing: "easeOutExpo"})
    		$(this).find("span").stop().animate({top:"100px"}, {duration:700, easing: "easeOutExpo"})
  	})

  	$('aside li a')
    	.mouseover(function(){    	  
    		$(this).animate({ paddingLeft: '5px' }, 150);
    	})
    	.mouseout(function(){
    		$(this).animate({ paddingLeft: '0px' }, 150);
  	})
  	
    var today=new Date(); 
    var bday=new Date(today.getFullYear(), 11, 16); if (today.getMonth()==11 && today.getDate()>16) bday.setFullYear(bday.getFullYear()+1); var days_left = Math.ceil(((bday.getTime()-today.getTime())/(1000*60*60*24))/365*100)
    var college=new Date(today.getFullYear(), 4, 28); if (today.getMonth() == 4 && today.getDate() > 28) college = 100; var college_days_left = 100-Math.ceil(((college.getTime()-today.getTime())/(1000*60*60*24))/365*100)
	var c1 = "#332f29"
	var c2 = "#8fa68e"
	var c3 = "#ccc59e"
	var c4 = "#cc3910"
	$('#content-header').css('background-color',c4)
    $('#wrapper').append('<div class="get"><div class="arc"><span class="text">College</span><input type="hidden" class="percent" value="100" /><input type="hidden" class="color" value="'+c1+'" /></div><div class="arc"><span class="text">Age 22</span><input type="hidden" class="percent" value="'+days_left+'" /><input type="hidden" class="color" value="'+c2+'" /></div><div class="arc"><span class="text">27in Mac</span><input type="hidden" class="percent" value="52" /><input type="hidden" class="color" value="'+c3+'" /></div></div>');

	$('#list-view').click(function () {
		$('article').addClass('list');
		return false;
	});

	$('#grid-view').click(function () {
		$('article').removeClass('list');
		return false;
	});
	
	$('.logo').tipsy({left:5})
	$('.blog').tipsy()
});

// codrops up in here - http://tympanus.net/Tutorials/AnimatedSkillsDiagram/
var o = {
	init: function(){
		this.diagram();
	},
	random: function(l, u){
		return Math.floor((Math.random()*(u-l+1))+l);
	},
	diagram: function(){
		var r = Raphael('diagram', 300, 400),
			rad = 40,
			defaultText = ' ',
			speed = 250;
		
		var size = 130;
		var stroke_width = 20;
		
		r.circle(size, size, 51).attr({ stroke: 'none', fill: '#000' });
		
		var title = r.text(size, size, defaultText).attr({
			font: '16px "proxima-nova-1"',
			fill: '#fff'
		}).toFront();
		
		var image = r.image("images/life2.png",115,125,29,14).toFront();
		title.animate({ opacity: 0 }, speed, '>')
		
		r.customAttributes.arc = function(value, color, rad){
			var v = 3.6*value,
				alpha = v == 360 ? 359.99 : v,
				random = o.random(91, 240),
				a = (random-alpha) * Math.PI/180,
				b = random * Math.PI/180,
				sx = size + rad * Math.cos(b),
				sy = size - rad * Math.sin(b),
				x = size + rad * Math.cos(a),
				y = size - rad * Math.sin(a),
				path = [['M', sx, sy], ['A', rad, rad, 0, +(alpha > 180), 1, x, y]];
			return { path: path, stroke: color }
		}
		
		$('.get').find('.arc').each(function(i){
			var t = $(this), 
				color = t.find('.color').val(),
				value = t.find('.percent').val(),
				text = t.find('.text').text();
			
			rad += 25;	
			var z = r.path().attr({ arc: [value, color, rad], 'stroke-width': stroke_width });
			
			z.mouseover(function(){
                this.stop().animate({ 'stroke-width': stroke_width+10, opacity: .75 }, speed*4, 'elastic').toFront();
				image.stop().animate({ opacity: 0 }, speed, '>')
				title.stop().animate({ opacity: 0 }, speed, 'fast', function(){
					this.attr({ text: text + '\n' + value + '%' }).animate({ opacity: 1 }, speed, 'fast');
				});
            }).mouseout(function(){
				this.stop().animate({ 'stroke-width': stroke_width, opacity: 1 }, speed*4, 'elastic');
				image.stop().animate({ opacity: 1 }, speed, '>')
				title.stop().animate({ opacity: 0 }, speed, 'fast', function(){
					title.attr({ text: defaultText }).animate({ opacity: 1 }, speed, 'fast');
				});	
            });
		});
		
	}
}
$(function(){ o.init(); });

(function($){var g='bgPos';$.fx.step['backgroundPosition']=$.fx.step['background-position']=function(a){if(!a.set){var b=$(a.elem);var c=b.data(g);b.css('backgroundPosition',c);a.start=parseBackgroundPosition(c);a.end=parseBackgroundPosition(a.options.curAnim['backgroundPosition']||a.options.curAnim['background-position']);for(var i=0;i<a.end.length;i++){if(a.end[i][0]){a.end[i][1]=a.start[i][1]+(a.end[i][0]=='-='?-1:+1)*a.end[i][1]}}a.set=true}$(a.elem).css('background-position',((a.pos*(a.end[0][1]-a.start[0][1])+a.start[0][1])+a.end[0][2])+' '+((a.pos*(a.end[1][1]-a.start[1][1])+a.start[1][1])+a.end[1][2]))};function parseBackgroundPosition(c){var d={center:'50%',left:'0%',right:'100%',top:'0%',bottom:'100%'};var e=c.split(/ /);var f=function(a){var b=(d[e[a]]||e[a]||'50%').match(/^([+-]=)?([+-]?\d+(\.\d*)?)(.*)$/);e[a]=[b[1],parseFloat(b[2]),b[4]||'px']};if(e.length==1&&$.inArray(e[0],['top','bottom'])>-1){e[1]=e[0];e[0]='50%'}f(0);f(1);return e}$.fn.animate=function(e){return function(a,b,c,d){if(a['backgroundPosition']||a['background-position']){$(this).data(g,this.css('backgroundPosition'))}return e.apply($(this),[a,b,c,d])}}($.fn.animate)})(jQuery);

/*
 * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/
 *
 * Uses the built in easing capabilities added In jQuery 1.1
 * to offer multiple easing options
 *
 * TERMS OF USE - jQuery Easing
 * 
 * Open source under the BSD License. 
 * 
 * Copyright Ã‚Â© 2008 George McGinley Smith
 * All rights reserved.
*/

// t: current time, b: begInnIng value, c: change In value, d: duration
jQuery.easing['jswing'] = jQuery.easing['swing'];

jQuery.extend( jQuery.easing,
{
	def: 'easeOutQuad',
	swing: function (x, t, b, c, d) {
		//alert(jQuery.easing.default);
		return jQuery.easing[jQuery.easing.def](x, t, b, c, d);
	},
	easeInQuad: function (x, t, b, c, d) {
		return c*(t/=d)*t + b;
	},
	easeOutQuad: function (x, t, b, c, d) {
		return -c *(t/=d)*(t-2) + b;
	},
	easeInOutQuad: function (x, t, b, c, d) {
		if ((t/=d/2) < 1) return c/2*t*t + b;
		return -c/2 * ((--t)*(t-2) - 1) + b;
	},
	easeInCubic: function (x, t, b, c, d) {
		return c*(t/=d)*t*t + b;
	},
	easeOutCubic: function (x, t, b, c, d) {
		return c*((t=t/d-1)*t*t + 1) + b;
	},
	easeInOutCubic: function (x, t, b, c, d) {
		if ((t/=d/2) < 1) return c/2*t*t*t + b;
		return c/2*((t-=2)*t*t + 2) + b;
	},
	easeInQuart: function (x, t, b, c, d) {
		return c*(t/=d)*t*t*t + b;
	},
	easeOutQuart: function (x, t, b, c, d) {
		return -c * ((t=t/d-1)*t*t*t - 1) + b;
	},
	easeInOutQuart: function (x, t, b, c, d) {
		if ((t/=d/2) < 1) return c/2*t*t*t*t + b;
		return -c/2 * ((t-=2)*t*t*t - 2) + b;
	},
	easeInQuint: function (x, t, b, c, d) {
		return c*(t/=d)*t*t*t*t + b;
	},
	easeOutQuint: function (x, t, b, c, d) {
		return c*((t=t/d-1)*t*t*t*t + 1) + b;
	},
	easeInOutQuint: function (x, t, b, c, d) {
		if ((t/=d/2) < 1) return c/2*t*t*t*t*t + b;
		return c/2*((t-=2)*t*t*t*t + 2) + b;
	},
	easeInSine: function (x, t, b, c, d) {
		return -c * Math.cos(t/d * (Math.PI/2)) + c + b;
	},
	easeOutSine: function (x, t, b, c, d) {
		return c * Math.sin(t/d * (Math.PI/2)) + b;
	},
	easeInOutSine: function (x, t, b, c, d) {
		return -c/2 * (Math.cos(Math.PI*t/d) - 1) + b;
	},
	easeInExpo: function (x, t, b, c, d) {
		return (t==0) ? b : c * Math.pow(2, 10 * (t/d - 1)) + b;
	},
	easeOutExpo: function (x, t, b, c, d) {
		return (t==d) ? b+c : c * (-Math.pow(2, -10 * t/d) + 1) + b;
	},
	easeInOutExpo: function (x, t, b, c, d) {
		if (t==0) return b;
		if (t==d) return b+c;
		if ((t/=d/2) < 1) return c/2 * Math.pow(2, 10 * (t - 1)) + b;
		return c/2 * (-Math.pow(2, -10 * --t) + 2) + b;
	},
	easeInCirc: function (x, t, b, c, d) {
		return -c * (Math.sqrt(1 - (t/=d)*t) - 1) + b;
	},
	easeOutCirc: function (x, t, b, c, d) {
		return c * Math.sqrt(1 - (t=t/d-1)*t) + b;
	},
	easeInOutCirc: function (x, t, b, c, d) {
		if ((t/=d/2) < 1) return -c/2 * (Math.sqrt(1 - t*t) - 1) + b;
		return c/2 * (Math.sqrt(1 - (t-=2)*t) + 1) + b;
	},
	easeInElastic: function (x, t, b, c, d) {
		var s=1.70158;var p=0;var a=c;
		if (t==0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*.3;
		if (a < Math.abs(c)) { a=c; var s=p/4; }
		else var s = p/(2*Math.PI) * Math.asin (c/a);
		return -(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;
	},
	easeOutElastic: function (x, t, b, c, d) {
		var s=1.70158;var p=0;var a=c;
		if (t==0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*.3;
		if (a < Math.abs(c)) { a=c; var s=p/4; }
		else var s = p/(2*Math.PI) * Math.asin (c/a);
		return a*Math.pow(2,-10*t) * Math.sin( (t*d-s)*(2*Math.PI)/p ) + c + b;
	},
	easeInOutElastic: function (x, t, b, c, d) {
		var s=1.70158;var p=0;var a=c;
		if (t==0) return b;  if ((t/=d/2)==2) return b+c;  if (!p) p=d*(.3*1.5);
		if (a < Math.abs(c)) { a=c; var s=p/4; }
		else var s = p/(2*Math.PI) * Math.asin (c/a);
		if (t < 1) return -.5*(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;
		return a*Math.pow(2,-10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )*.5 + c + b;
	},
	easeInBack: function (x, t, b, c, d, s) {
		if (s == undefined) s = 1.70158;
		return c*(t/=d)*t*((s+1)*t - s) + b;
	},
	easeOutBack: function (x, t, b, c, d, s) {
		if (s == undefined) s = 1.70158;
		return c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;
	},
	easeInOutBack: function (x, t, b, c, d, s) {
		if (s == undefined) s = 1.70158; 
		if ((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;
		return c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;
	},
	easeInBounce: function (x, t, b, c, d) {
		return c - jQuery.easing.easeOutBounce (x, d-t, 0, c, d) + b;
	},
	easeOutBounce: function (x, t, b, c, d) {
		if ((t/=d) < (1/2.75)) {
			return c*(7.5625*t*t) + b;
		} else if (t < (2/2.75)) {
			return c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;
		} else if (t < (2.5/2.75)) {
			return c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;
		} else {
			return c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;
		}
	},
	easeInOutBounce: function (x, t, b, c, d) {
		if (t < d/2) return jQuery.easing.easeInBounce (x, t*2, 0, c, d) * .5 + b;
		return jQuery.easing.easeOutBounce (x, t*2-d, 0, c, d) * .5 + c*.5 + b;
	}
});

// tipsy, facebook style tooltips for jquery
// version 1.0.0a
// (c) 2008-2010 jason frame [jason@onehackoranother.com]
// released under the MIT license

(function($) {
    
    function maybeCall(thing, ctx) {
        return (typeof thing == 'function') ? (thing.call(ctx)) : thing;
    };
    
    function Tipsy(element, options) {
        this.$element = $(element);
        this.options = options;
        this.enabled = true;
        this.fixTitle();
    };
    
    Tipsy.prototype = {
        show: function() {
            var title = this.getTitle();
            if (title && this.enabled) {
                var $tip = this.tip();
                
                $tip.find('.tipsy-inner')[this.options.html ? 'html' : 'text'](title);
                $tip[0].className = 'tipsy'; // reset classname in case of dynamic gravity
                $tip.remove().css({top: 0, left: 0, visibility: 'hidden', display: 'block'}).prependTo(document.body);
                
                var pos = $.extend({}, this.$element.offset(), {
                    width: this.$element[0].offsetWidth,
                    height: this.$element[0].offsetHeight
                });
                
                var actualWidth = $tip[0].offsetWidth,
                    actualHeight = $tip[0].offsetHeight,
                    gravity = maybeCall(this.options.gravity, this.$element[0]);
                
                var tp;
                switch (gravity.charAt(0)) {
                    case 'n':
                        tp = {top: pos.top + pos.height + this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};
                        break;
                    case 's':
                        tp = {top: pos.top - actualHeight - this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};
                        break;
                    case 'e':
                        tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth - this.options.offset};
                        break;
                    case 'w':
                        tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width + this.options.offset};
                        break;
                }
                
                if (gravity.length == 2) {
                    if (gravity.charAt(1) == 'w') {
                        tp.left = pos.left + pos.width / 2 - 15;
                    } else {
                        tp.left = pos.left + pos.width / 2 - actualWidth + 15;
                    }
                }
                
                $tip.css(tp).addClass('tipsy-' + gravity);
                $tip.find('.tipsy-arrow')[0].className = 'tipsy-arrow tipsy-arrow-' + gravity.charAt(0);
                if (this.options.className) {
                    $tip.addClass(maybeCall(this.options.className, this.$element[0]));
                }
                
                if (this.options.fade) {
                    $tip.stop().css({opacity: 0, display: 'block', visibility: 'visible'}).animate({opacity: this.options.opacity});
                } else {
                    $tip.css({visibility: 'visible', opacity: this.options.opacity});
                }
            }
        },
        
        hide: function() {
            if (this.options.fade) {
                this.tip().stop().fadeOut(function() { $(this).remove(); });
            } else {
                this.tip().remove();
            }
        },
        
        fixTitle: function() {
            var $e = this.$element;
            if ($e.attr('title') || typeof($e.attr('original-title')) != 'string') {
                $e.attr('original-title', $e.attr('title') || '').removeAttr('title');
            }
        },
        
        getTitle: function() {
            var title, $e = this.$element, o = this.options;
            this.fixTitle();
            var title, o = this.options;
            if (typeof o.title == 'string') {
                title = $e.attr(o.title == 'title' ? 'original-title' : o.title);
            } else if (typeof o.title == 'function') {
                title = o.title.call($e[0]);
            }
            title = ('' + title).replace(/(^\s*|\s*$)/, "");
            return title || o.fallback;
        },
        
        tip: function() {
            if (!this.$tip) {
				pad = 9 + this.options.left
                this.$tip = $('<div class="tipsy" style="margin-left: '+pad+'px"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');
            }
            return this.$tip;
        },
        
        validate: function() {
            if (!this.$element[0].parentNode) {
                this.hide();
                this.$element = null;
                this.options = null;
            }
        },
        
        enable: function() { this.enabled = true; },
        disable: function() { this.enabled = false; },
        toggleEnabled: function() { this.enabled = !this.enabled; }
    };
    
    $.fn.tipsy = function(options) {
        
        if (options === true) {
            return this.data('tipsy');
        } else if (typeof options == 'string') {
            var tipsy = this.data('tipsy');
            if (tipsy) tipsy[options]();
            return this;
        }
        
        options = $.extend({}, $.fn.tipsy.defaults, options);
        
        function get(ele) {
            var tipsy = $.data(ele, 'tipsy');
            if (!tipsy) {
                tipsy = new Tipsy(ele, $.fn.tipsy.elementOptions(ele, options));
                $.data(ele, 'tipsy', tipsy);
            }
            return tipsy;
        }
        
        function enter() {
            var tipsy = get(this);
            tipsy.hoverState = 'in';
            if (options.delayIn == 0) {
                tipsy.show();
            } else {
                tipsy.fixTitle();
                setTimeout(function() { if (tipsy.hoverState == 'in') tipsy.show(); }, options.delayIn);
            }
        };
        
        function leave() {
            var tipsy = get(this);
            tipsy.hoverState = 'out';
            if (options.delayOut == 0) {
                tipsy.hide();
            } else {
                setTimeout(function() { if (tipsy.hoverState == 'out') tipsy.hide(); }, options.delayOut);
            }
        };
        
        if (!options.live) this.each(function() { get(this); });
        
        if (options.trigger != 'manual') {
            var binder   = options.live ? 'live' : 'bind',
                eventIn  = options.trigger == 'hover' ? 'mouseenter' : 'focus',
                eventOut = options.trigger == 'hover' ? 'mouseleave' : 'blur';
            this[binder](eventIn, enter)[binder](eventOut, leave);
        }
        
        return this;
        
    };
    
    $.fn.tipsy.defaults = {
        className: null,
        delayIn: 0,
		left: 0,
        delayOut: 0,
        fade: true,
        fallback: '',
        gravity: 'n',
        html: false,
        live: false,
        offset: 0,
        opacity: 0.9,
        title: 'title',
        trigger: 'hover'
    };
    
    // Overwrite this method to provide options on a per-element basis.
    // For example, you could store the gravity in a 'tipsy-gravity' attribute:
    // return $.extend({}, options, {gravity: $(ele).attr('tipsy-gravity') || 'n' });
    // (remember - do not modify 'options' in place!)
    $.fn.tipsy.elementOptions = function(ele, options) {
        return $.metadata ? $.extend({}, options, $(ele).metadata()) : options;
    };
    
    $.fn.tipsy.autoNS = function() {
        return $(this).offset().top > ($(document).scrollTop() + $(window).height() / 2) ? 's' : 'n';
    };
    
    $.fn.tipsy.autoWE = function() {
        return $(this).offset().left > ($(document).scrollLeft() + $(window).width() / 2) ? 'e' : 'w';
    };
    
    /**
     * yields a closure of the supplied parameters, producing a function that takes
     * no arguments and is suitable for use as an autogravity function like so:
     *
     * @param margin (int) - distance from the viewable region edge that an
     *        element should be before setting its tooltip's gravity to be away
     *        from that edge.
     * @param prefer (string, e.g. 'n', 'sw', 'w') - the direction to prefer
     *        if there are no viewable region edges effecting the tooltip's
     *        gravity. It will try to vary from this minimally, for example,
     *        if 'sw' is preferred and an element is near the right viewable 
     *        region edge, but not the top edge, it will set the gravity for
     *        that element's tooltip to be 'se', preserving the southern
     *        component.
     */
     $.fn.tipsy.autoBounds = function(margin, prefer) {
		return function() {
			var dir = {ns: prefer[0], ew: (prefer.length > 1 ? prefer[1] : false)},
			    boundTop = $(document).scrollTop() + margin,
			    boundLeft = $(document).scrollLeft() + margin,
			    $this = $(this);

			if ($this.offset().top < boundTop) dir.ns = 'n';
			if ($this.offset().left < boundLeft) dir.ew = 'w';
			if ($(window).width() + $(document).scrollLeft() - $this.offset().left < margin) dir.ew = 'e';
			if ($(window).height() + $(document).scrollTop() - $this.offset().top < margin) dir.ns = 's';

			return dir.ns + (dir.ew ? dir.ew : '');
		}
	};
    
})(jQuery);